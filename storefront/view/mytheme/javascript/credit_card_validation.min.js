jQuery(document).ready(function(){$("form.validate-creditcard").aCCValidator({}),$("form.validate-creditcard #cc_number").bind({change:function(){$.aCCValidator.precheckCCNumber($(this))},blur:function(){$.aCCValidator.checkCCNumber($(this))},keyup:function(a){13==a.keyCode?$("form.validate-creditcard").submit():$(this).val()&&$.aCCValidator.precheckCCNumber($(this))}}),$("form.validate-creditcard #cc_owner").bind({change:function(){$.aCCValidator.checkCCName($(this),"reset")},blur:function(){$.aCCValidator.checkCCName($(this))},keyup:function(a){13==a.keyCode?$("form.validate-creditcard").submit():$.aCCValidator.checkCCName($(this),"reset")}}),$("form.validate-creditcard #cc_cvv2").bind({change:function(){$.aCCValidator.checkCVV($(this),"reset")},blur:function(){$.aCCValidator.checkCVV($(this))},keyup:function(a){13==a.keyCode?$("form.validate-creditcard").submit():$.aCCValidator.checkCVV($(this),"reset")}})}),function(a){a.aCCValidator={defaults:{cards:[{name:"Visa",code:"visa",length:"13,16",prefixes:"4",checkdigit:!0},{name:"DinersClub",code:"diners",length:"14,16",prefixes:"36,38,39,54,55",checkdigit:!0},{name:"DinersClub",code:"dc",length:"14,16",prefixes:"36,38,39,54,55",checkdigit:!0},{name:"Diners Club Carte Blanche",code:"cblanche",length:"14",prefixes:"300,301,302,303,304,305",checkdigit:!0},{name:"MasterCard",code:"mc",length:"16",prefixes:"51,52,53,54,55",checkdigit:!0},{name:"MasterCard",code:"mastercard",length:"16",prefixes:"51,52,53,54,55",checkdigit:!0},{name:"American Express",code:"amex",length:"15",prefixes:"34,37",checkdigit:!0},{name:"China UnionPay",code:"unionpay",length:"16,17,18,19",prefixes:"62",checkdigit:!1},{name:"Discover",code:"discover",length:"16",prefixes:"6011,622,64,65",checkdigit:!0},{name:"JCB",code:"jcb",length:"16",prefixes:"35",checkdigit:!0},{name:"InterPayment",code:"interpayment",length:"16,17,18,19",prefixes:"636",checkdigit:!0},{name:"InstaPayment",code:"instapayment",length:"16",prefixes:"637,638,639",checkdigit:!0},{name:"Switch",code:"switch",length:"16,18,19",prefixes:"4903,4905,4911,4936,564182,633110,6333,6759",checkdigit:!0},{name:"Maestro",code:"maestro",length:"12,13,14,15,16,18,19",prefixes:"5018,5020,5038,6304,6759,6761,6762,6763",checkdigit:!0},{name:"VisaElectron",code:"visaelectron",length:"16",prefixes:"4026,417500,4508,4844,4913,4917",checkdigit:!0},{name:"Dankort",code:"dankort",length:"16",prefixes:"5019",checkdigit:!0},{name:"LaserCard",code:"laser",length:"16,17,18,19",prefixes:"6304,6706,6771,6709",checkdigit:!0}],cc_field_name:"cc_owner",name_min:2,cvv_min:3,cvv_max:4,cc_field_number:"cc_number",cc_field_type:"cc_type",cc_field_cvv:"cc_cvv2",cc_field_month:"cc_expire_date_month",cc_field_year:"cc_expire_date_year",wrapper:'<span class="input-group-addon"></span>',warning:'<i class="fa fa-exclamation"></i>',success:'<i class="fa fa-check"></i>',error_class:"has-error",success_class:"has-success"}},a.fn.aCCValidator=function(b){var c=a.extend({},a.aCCValidator.defaults,b);a.aCCValidator.validate=function(b){var d=!1;return b.find("input, textarea, select").each(function(){var b=a(this);b.attr("name")==c.cc_field_name&&(a.aCCValidator.checkCCName(b)||(d=!0)),b.attr("name")==c.cc_field_number&&(a.aCCValidator.checkCCNumber(b)||(d=!0)),b.attr("name")==c.cc_field_type&&(b.val()&&"notfound"!=b.val()||(d=!0)),b.attr("name")==c.cc_field_cvv&&(a.aCCValidator.checkCVV(b)||(d=!0)),b.attr("name")==c.cc_field_month&&(a.aCCValidator.checkExp(b)||(d=!0)),b.attr("name")==c.cc_field_year&&(a.aCCValidator.checkExp(b)||(d=!0))}),!d},a.aCCValidator.precheckCCNumber=function(a){var b=a.val();b=b.replace(/\s/g,"");var d=a.closest(".input-group"),e=/^\d+$/;if(e.test(b)){if(b.length>3){d.removeClass(c.error_class),hide_addon(a);var f=lookupCreditCardType(b);f?select_cctype(a,f):hide_addon(a)}}else show_error(a,".input-group")},a.aCCValidator.checkCCNumber=function(a){var b=/^[0-9]{13,19}$/,c=a.val();return c=c.replace(/\s/g,""),b.test(c)&&CheckDigits(c)?(show_success(a,".input-group"),!0):(show_error(a,".input-group"),!1)},a.aCCValidator.checkCCName=function(a,b){var d=a.closest(".form-group");return"reset"==b?(d.removeClass(c.error_class),d.removeClass(c.success_class),hide_addon(a),!1):a.val().length<c.name_min?(show_error(a,".form-group"),!1):(show_success(a,".form-group"),!0)},a.aCCValidator.checkCVV=function(a,b){var d=a.closest(".form-group");return"reset"==b?(d.removeClass(c.error_class),d.removeClass(c.success_class),hide_addon(a),!1):a.val().length<c.cvv_min||a.val().length>c.cvv_max?(show_error(a,".form-group"),!1):(show_success(a,".form-group"),!0)},a.aCCValidator.checkExp=function(a,b){var d=a.closest(".input-group");return"reset"==b?(d.removeClass(c.error_class),d.removeClass(c.success_class),!1):a.val()?(show_success(a,".input-group","no_icon"),!0):(show_error(a,".input-group","no_icon"),!1)},select_cctype=function(b,c){var d=b.closest("form").find("#cc_type");if(d.length){var e,f;d.find("option").each(function(){return a(this).val().toLowerCase()==c.toLowerCase()?(a(this).prop("selected",!0),void(f=!0)):void("notfound"==a(this).val()&&(e=!0))}),f?show_success(d,".input-group","no_icon"):(e||(d.append('<option value="notfound"></option>'),d.find("option").each(function(){"notfound"==a(this).val()&&a(this).prop("selected",!0)})),show_error(d,".input-group","no_icon"))}},show_addon=function(a,b){var d=a.closest(".input-group");d.find(".input-group-addon").length||d.append(c.wrapper),d.find(".input-group-addon").html(b)},hide_addon=function(a){var b=a.closest(".input-group");b.find(".input-group-addon").length&&b.find(".input-group-addon").remove()},show_success=function(a,b,d){var e=a.closest(b);e.removeClass(c.error_class),e.addClass(c.success_class),"no_icon"!=d&&(hide_addon(a),show_addon(a,c.success))},show_error=function(a,b,d){var e=a.closest(b);e.removeClass(c.success_class),e.addClass(c.error_class),"no_icon"!=d&&(hide_addon(a),show_addon(a,c.warning))},lookupCreditCardType=function(a){for(i=c.cards.length-1;i>=0;i--)for(prefix_arr=c.cards[i].prefixes.split(","),j=0;j<prefix_arr.length;j++){var b=new RegExp("^"+prefix_arr[j]);if(b.test(a))return c.cards[i].code.toLowerCase()}return!1},CheckDigits=function(a){var b;for(i=c.cards.length-1;i>=0;i--)for(prefix_arr=c.cards[i].prefixes.split(","),g=0;g<prefix_arr.length;g++){var d=new RegExp("^"+prefix_arr[g]);d.test(a)&&(b=c.cards[i])}if(b&&b.checkdigit){var e,f=0,g=1;for(i=b.length-1;i>=0;i--)e=Number(a.charAt(i))*g,e>9&&(f+=1,e-=10),f+=e,g=1==g?2:1;if(f%10!=0)return!1;var h=b.length.split(",");for(g=0;g<h.length;g++)if(a.length==h[g])return!0;return!1}return!1}}}(jQuery);